# HW4: Tf-Idf с использованием Spark DataFrame API
#### По данным Trip advisor hotel reviews посчитать Tf-Idf с помощью Spark DataFrame / Dataset API без использования Spark ML
Dataset from https://www.kaggle.com/andrewmvd/trip-advisor-hotel-reviews

Building with sbt running in IDEA

Этапы:
* Привести все к одному регистру
* Удалить все спецсимволы
* Посчитать частоту слова в предложении
* Посчитать количество документов со словом
* Взять только 100 самых встречаемых
* Сджойнить две полученные таблички и посчитать Tf-Idf (только для слов из предыдущего пункта)
* Запайвотить табличку

####Results:

| id| area|arrived| away| bar|bathroom|beach|beautiful|  bed| beds| best|better|  big| bit|booked|breakfast|buffet|check| city|clean|close|comfortable|  day|days|definitely| desk|  did|excellent|experience|fantastic|floor| food| free|friendly|going| good|  got|great|helpful|hotel|hotels| just|large| like|little|lobby|location| lot|loved|lovely| make|minutes|morning|need| new| nice|night|nights|   no|  not|   nt|people|perfect|place|pool|price|problem|quiet|quite|really|recommend|resort|restaurant|restaurants|reviews|right| room|rooms| say|service|shower|small|staff| stay|stayed|street| sure|think| time|times| took| trip|  use| view| walk|walking|want|water|  way| went|wonderful|
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
|  0| null|  0.025| null|null|    null| null|     null|0.021| null| null|  null| null|null|  null|     null|  null|0.026| null|0.015| null|      0.021| null|null|      null| null| 0.03|     null|     0.024|     null| null| null| null|    null| null|0.013| 0.02|0.012|   null|0.018|  null|0.015| null|0.018| 0.019| null|   0.014|null| null|  null| null|   null|  0.025|null|null|0.074|0.032|  null| null|0.022| null|  0.02|   null| null|null| null|   null| null| null|  null|     null|  null|      null|       null|  0.023| null| 0.03| null|null|   null|  null| null| null|0.025|  null|  null| null| null| null| null|0.026| null| null|0.022| null|  0.025|null| null| null| null|     null|
|  1| null|  0.009|0.008|null|   0.014| null|     null| null|0.009|0.007| 0.016| null|null| 0.008|    0.016|  null| null| null|0.005| null|       null|0.006|null|      null|0.032|0.011|     null|      null|     null| null| null|0.008|    null| null|0.019|0.021|0.004|  0.006|0.016| 0.016| null| null|0.013|  null| null|    null|null| null|  null|0.008|   null|  0.009|null|null|0.005|0.011|  null|0.017|0.027| null|  null|   null| null|null| null|   null| null| null| 0.007|     null|  null|      null|       null|   null| null|0.021| null|null|   null|  null| null|0.008|0.004|  null|  null|0.009| null| null| null|0.009|0.008| null|0.008| null|   null|null| null| null| null|     null|
|  2| null|   null|0.009|null|   0.016| null|     null|0.017| null| null|  null| 0.01|null|  null|     null|  null|0.011| null| null| null|      0.008| null|null|      null|0.027|0.018|     null|      0.01|     null| null| null| null|    null| 0.01|0.005|0.016|0.014|   null|0.011|  null| null|0.009| null|  null| null|    null|null| null|  null| null|   null|   0.03|null|null|0.018|0.033|  null|0.013|0.005|0.034|  null|   null| null|null|0.009|   null| null| null|  null|     null|  null|      null|       null|   null| null|0.033|0.006|null|  0.007|  null| null| null| 0.02|  null|  null| null| null| null| null| null| null|0.011| null| null|   null|null|0.009|0.009| null|     null|
|  3|0.039|   null| null|null|    null| null|     null| null| null| null|  null|0.025|null|  null|     null|  null| null| null| null| null|       null| null|null|      null| null| 0.03|    0.038|      null|     null| null| null|0.045|   0.033| null| null| null|0.035|   null|0.036|  null| null| null|0.035|  null|0.024|   0.014|null| null| 0.025| null|   null|   null|null|null|0.029| null|  null|0.015| null|0.027|  null|   null| null|null| null|   null| null| null|  null|     null|  null|      null|       null|   null| null| 0.01| null|null|  0.016|  null| null|0.011|0.024|  null|  null| null| null|0.016| null| null| null| null| null| null|   null|null| null| null| null|    0.022|
|  4|0.009|   null| 0.01|null|   0.009| null|     null| null| null|0.009|  0.01| null|null|  0.01|     null|  null|0.012|0.011| null| null|       null| null|null|      null| 0.01|0.035|     null|      null|     null| 0.01| null| null|    null|0.011|0.006|0.009|0.022|  0.008|0.008|  0.01|0.013|0.011| null|  null| null|    null|null| null|  null| null|   null|   null|null|null| null| null|  null|0.007| 0.01|0.038|  null|   null|0.008|null|0.011|  0.012| null| null|  null|    0.009|  null|      null|       null|   null| 0.01|0.009| null|null|  0.015|  null| null|0.005|0.011|  null| 0.011| null| null|0.008| null|0.012| null| null| 0.01|0.009|   null|0.01| null| 0.01| 0.01|    0.011|
|  5| null|   null| null|null|    null| null|    0.014| null| null|0.013| 0.015| null|null| 0.015|     null|  null| null| null| null| null|       null| null|null|     0.016|0.015| null|     null|      null|     null| null|0.011| null|    null| null|0.009| null| null|   null|0.012|  null| null| null| null|  null| null|    null|null| null|  null| null|   null|  0.016|null|null| null| null|  null| null|0.007|0.009|  null|   null|0.012|null| null|   null|0.016| null|  null|     null|  null|     0.028|       null|   null| null|0.013| null|null|  0.011|  null| null|0.008|0.016| 0.009|  null| null| null| null| null| null| null| null| null| null|   null|null| null|0.015|0.015|    0.015|
|  6| null|   null| null|null|   0.017| null|     null| null| null| null|  null| null|null|  0.02|     null|  null| null| 0.02|0.013| null|      0.054| null|null|      null| null|0.013|     null|     0.021|     null| null| null| null|   0.015| null|0.023| null| 0.01|   null|0.008|  null| null| 0.02| null|  null| null|   0.012|null| null|  null| null|   null|   null|null|null| null| null| 0.018| null| 0.01| null|  null|   null| null|null| null|  0.022| null|0.021|  null|     null|  null|      null|       null|   null| null|0.017|0.012|null|   null|  null|0.016| 0.02|0.022|  null| 0.062| null| null| null| null| null|0.018| null|0.019|0.016|   null|null| null| null| null|     null|
|  7| 0.02|   null| null|null|    null| null|     null|0.021| null| null|  null| null|null|  null|     null|  null| null| null| null|0.024|       null| null|null|      null|0.023| null|     0.04|      null|     null| null|0.018| null|    null| null|0.013| null| null|   null|0.009|  null| null| null|0.018|  null| null|   0.014|null| null|  null|0.047|   null|   null|null|null|0.015| null|  null| null|0.011| null|  null|   null| null|null| null|   null| null| null|  null|     null|  null|      null|       null|   null| null| null| null|null|  0.033|  null| null|0.059| null|  null| 0.024| null| null| null| null|0.026| null| null| null| null|  0.025|null| null|0.023|0.023|     null|
|  8| null|   null|0.033|null|    null| null|     null|0.061| null| null|  null| null|null|  null|     null|  null| null| null| null| null|       null| null|null|      null| null| null|     null|      null|     null| null|0.026| null|    null| null| null| null|0.034|   null| 0.04|  null| null| null|0.026|  null| null|   0.021|null| null|  null| null|   null|   null|null|null| null| null|  null| null| null| null|  null|   null| null|null| null|   null| null| null|  null|     null|  null|      null|       null|   null| null|0.029| 0.02|null|   null|  null| null| null| null|  0.02|  null| null| null| null| null| null| null| null| null|0.028|   null|null| null| null| null|     null|
|  9| null|   null| null|null|    null| null|     null| 0.05| null| null|  null| null|null|  null|     null|  null| null| null| null| null|       0.05| null|null|      null| null| null|    0.047|     0.059|     null| null| null| null|   0.041| null| null| null|0.028|   null|0.022|  null| null| null| null|  null| null|    null|null| 0.06|  null| null|   null|   null|null|null| null| null|  null| null| null| null|  null|   null| null|null| null|   null| null| null|  null|     null|  null|      null|       0.05|   null| null|0.024| null|null|   null|  null|0.045|0.055| null| 0.033|  null| null| null| null| null| null| null| null| null| null|   null|null| null| null| null|     null|

